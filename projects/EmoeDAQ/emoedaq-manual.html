<!DOCTYPE html>

<html lang="zh-CN"  class=" language_zh ">


<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="keywords" content="EmoeDAQ">
    
    
    <meta name="description" content="EmoeDAQ 用户手册">
    
    <meta name="generator" content="teedoc">
    <meta name="theme" content="teedoc-plugin-theme-default">
    
        
        <meta name="markdown-generator" content="teedoc-plugin-markdown-parser">
        
        <script>
MathJax = {"loader": {"load": ["output/svg"]}, "tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]]}, "svg": {"fontCache": "global"}};
</script>
        
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
        <script src="/static/js/theme_default/pre_main.js"></script>
        
        <link rel="stylesheet" href="/static/css/theme_default/prism.min.css" type="text/css"/>
        
        <link rel="stylesheet" href="/static/css/theme_default/viewer.min.css" type="text/css"/>
        
        <link rel="stylesheet" href="/static/css/theme_default/dark.css" type="text/css"/>
        
        <link rel="stylesheet" href="/static/css/theme_default/light.css" type="text/css"/>
        
        <script src="/static/js/theme_default/jquery.min.js"></script>
        
        <script src="/static/js/theme_default/split.js"></script>
        
        <link rel="stylesheet" href="/static/css/search/style.css" type="text/css"/>
        
        <meta name="blog-generator" content="teedoc-plugin-blog">
        
        <link rel="stylesheet" href="/static/css/custom.css" type="text/css"/>
        
    
    
    <title>EmoeDAQ 用户手册 - Emoe R&D</title>
    
    <script type="text/javascript">js_vars = {}</script>
    <script type="text/javascript">metadata = {"tags": ["analog", "emoedaq"], "date": false, "update": [], "ts": 0, "author": "Floydfish", "brief": "", "cover": ""}</script>
</head>


<body class="type_doc">
    
    <div id="navbar">
        <div id="navbar_menu">
            <a class="site_title" href="/">
                
                    <img class="site_logo" src="/static/image/emoe_640x640.jpg" alt="emoe r&d logo">
                
                
                    <h2>Emoe R&D</h2>
                
        </a>
            <a id="navbar_menu_btn"></a>
        </div>
        <div id="navbar_items">
            <div>
                <ul id="nav_left">
<li class="active"><a  href="/projects/">产品文档</a></li>
<li class=""><a  href="/blog/">项目规划</a></li>
</ul>

            </div>
            <div>
                <ul id="nav_right">
<li class=""><a target="_blank" href="https://github.com/emoestudio">EmoeR&D Github</a></li>
</ul>

                <ul class="nav_plugins"><li><a id="themes" class="light"></a></li></ul><ul class="nav_plugins"><li><a id="search"><span class="icon"></span><span class="placeholder">搜索</span>
                            <div id="search_hints">
                                <span id="search_input_hint">输入关键词，多关键词空格隔开</span>
                                <span id="search_loading_hint">正在加载，请稍候。。。</span>
                                <span id="search_download_err_hint">下载文件失败，请刷新重试或检查网络</span>
                                <span id="search_other_docs_result_hint">来自其它文档的结果</span>
                                <span id="search_curr_doc_result_hint">当前文档搜索结果</span>
                            </div></a></li></ul>
            </div>
        </div>
    </div>
    
    <div id="wrapper">
        <div id="sidebar_wrapper">
            <div id="sidebar">
                <div id="sidebar_title">
                    
                </div>
                <ul class="show">
<li class="not_active with_link"><a href="/projects/EmoePulse/emoepulse.html"><span class="label">EmoePulse</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/projects/EmoeNAP/emoenap.html"><span class="label">EmoeNAP</span><span class=""></span></a></li>
<li class="active_parent with_link"><a href="/projects/EmoeDAQ/emoedaq.html"><span class="label">EmoeDAQ</span><span class="sub_indicator"></span></a><ul class="show">
<li class="not_active with_link"><a href="/projects/EmoeDAQ/emoedaq-spec.html"><span class="label">EmoeDAQ Datasheet</span><span class=""></span></a></li>
<li class="active with_link"><a href="/projects/EmoeDAQ/emoedaq-manual.html"><span class="label">EmoeDAQ 用户手册</span><span class=""></span></a></li>
</ul>
</li>
</ul>

            </div>
        </div>
        <div id="article">
            <div id="menu_wrapper">
                <div id="menu">
                </div>
            </div>
            <div id="content_wrapper">
                <div id="content_body">
                    <div id="article_head">
                        <div id="article_title">
                            
                            <h1>EmoeDAQ 用户手册</h1>
                            
                        </div>
                        <div id="article_tags">
                            <ul>
                            
                                <li>analog</li>
                            
                                <li>emoedaq</li>
                            
                            </ul>
                        </div>
                        <div id="article_info">
                        <div id="article_info_left">
                            <span class="article_author">
                                Floydfish
                            </span>
                            
                        </div>
                        <div id="article_info_right">
                            
                        </div>
                        </div>
                    </div>
                    <div id="article_tools">
                        <span></span>
                        <span id="toc_btn"></span>
                    </div>
                    <div id="update_history">
                        
                    </div>
                    <div id="article_content">
                        
                            <h1 id="EmoeDAQ-%E7%94%A8%E6%88%B7%E6%89%8B%E5%86%8C">EmoeDAQ 用户手册</h1>
<blockquote>
<p>硬件版本: 1.4.0<br />
手册版本: 1.0.5<br />
固件版本:<br />
最后更新时间： 2025-03-27</p>
</blockquote>
<h2 id="%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%E6%8C%87%E5%8D%97">快速开始指南</h2>
<h3 id="%E8%BF%9E%E6%8E%A5%E8%BE%93%E5%85%A5%E4%BF%A1%E5%8F%B7">连接输入信号</h3>
<ul>
<li>单端测量</li>
</ul>
<p>将要使用的通道的IN-连接到GND，从IN+和另一个GND接入信号</p>
<ul>
<li>差分测量</li>
</ul>
<p>将GND连接到待测设备的GND，IN+和IN-分别接入待测设备的差分输出</p>
<ul>
<li>输入短路测试</li>
</ul>
<p>将CH1的IN+、IN-与GND连接（一个通道上的4个接线端子全部短接）</p>
<h3 id="%E8%BF%9E%E6%8E%A5%E9%80%89%E4%BB%B6">连接选件</h3>
<p>使用牛角座+排线插头连接外部选件，如果需要测量外部温度，需要连接外部测温传感器TMP117，TMP117的ADDR必须连接到VCC（对应I2C地址0x49，0x48被板上温度传感器占用）</p>
<h3 id="%E8%BF%9E%E6%8E%A5%E7%94%B5%E8%84%91">连接电脑</h3>
<ol>
<li>请确保PC的USB端口供电能力足够，<strong>不推荐连接到没有外部供电的劣质拓展坞上</strong>，此类拓展坞可能在VBUS上串联二极管，导致USB端口电压低于5V。</li>
<li>使用USB-TypeC数据线连接PC和DAQ，查看电脑的USB设备列表，应有<strong>USB串行设备(COM*)</strong></li>
<li>打开串口助手，选择DAQ的端口号，波特率可从9600至1500000之间随意选择，打开端口，发送命令：<em>IDN?（</em><em>附带换行，换行符为\n</em>*），查询设备型号以及版本号</li>
<li>发送命令：MEAS:VOLT:DC? 1 （<strong>附带换行，换行符为\n</strong>）以查询CH1的输入电压值。注意冒号为英文字符，切勿使用中文输入法。</li>
</ol>
<h3 id="%E8%BF%9E%E6%8E%A5%E7%A4%BA%E4%BE%8B%E4%B8%8A%E4%BD%8D%E6%9C%BA">连接示例上位机</h3>
<ol>
<li>下载EmoeDAQ <strong><a href="https://github.com/emoestudio/EmoeDAQ"  target="_blank">上位机</a></strong>(Release界面，若无法访问github，可在R&amp;D交流群群文件获取)</li>
<li>运行，选择端口号以及波特率，点击连接</li>
<li>启动CHx为单通道连续测量，启动扫描为2个输入通道切换扫描测量</li>
<li>设置NPLC可改变数据更新速率，但也会改变DAQ的测量本底噪声。NPLC越高，积分时间越长，噪声越低。</li>
<li>波形窗口视图可开启直方图和FFT分析，但需要注意直方图需要一定数据点积累后才能显示，FFT分析需要采集到足够多的数据点</li>
<li>FFT设置可调整FFT窗函数、FFT数据点数、以及幅度范围</li>
<li>显示控制窗口可控制采样的波形长度，默认为1w点，最大可调整至10w点。Y轴范围默认开启自动调节，也可手动指定</li>
<li>清空数据将清空采样buffer内所有数据，表头显示数据，波形曲线数据，以及统计数据</li>
<li>保存数据可以将2个通道的采样数据保存为csv文件</li>
<li>右键波形窗口可以选择Export，将波形导出为图片、svg等格式</li>
</ol>
<h2 id="DAQ%E6%8E%A7%E5%88%B6%E6%8C%87%E4%BB%A4%E9%9B%86">DAQ控制指令集</h2>
<p>EmoeDAQ采用SCPI指令集与上位机通过串口进行通讯。<br />
DAQ的SCPI指令集可以分为几类，分别是：</p>
<ul>
<li>IEEE 488.2标准命令</li>
<li>DAQ硬件配置命令</li>
<li>DAQ采样控制命令</li>
<li>DAQ系统命令</li>
</ul>
<p>SCPI指令集的简写为指定的单词开头（大写），比如 <code>CONFigure:VOLTage:DC:NPLCycles 10</code> 这句可以简写为 <code>CONF:VOLT:DC:NPLC 10</code>。</p>
<p>同时，SCPI标准指定的换行符为 LF(\n)。部分串口助手软件中默认的换行符为\r\n，推荐更改为 LF(\n)。</p>
<h3 id="IEEE-488.2%E6%A0%87%E5%87%86%E5%91%BD%E4%BB%A4">IEEE 488.2标准命令</h3>
<h4 id="%2ARST">*RST</h4>
<ul>
<li>格式：*<strong>RST</strong></li>
<li>功能：复位EmoeDAQ，使其硬件重新初始化</li>
<li>详细解释：接收到该命令后，DAQ会进行上电初始化操作。重新初始化后，DAQ进入出厂配置的默认工作状态</li>
<li>示例：*RST</li>
<li>返回值：&quot;system boot complete&quot;</li>
</ul>
<h4 id="%2AIDN%3F">*IDN?</h4>
<ul>
<li>格式：*<strong>IDN?</strong></li>
<li>功能：查询仪器ID信息</li>
<li>详细解释：接收到该命令后，设备返回仪器型号，以及软件版本号等信息</li>
<li>示例：*IDN?</li>
<li>返回值：仪器型号，以及软硬件版本号等信息</li>
</ul>
<h4 id="%2ACLS">*CLS</h4>
<ul>
<li>格式：*<strong>CLS</strong></li>
<li>功能：清除错误信息</li>
<li>详细解释：接收到该命令后，设备将清除累积的SCPI错误信息</li>
<li>示例：*CLS</li>
<li>返回值：无</li>
</ul>
<p>其他指令请参考IEEE488.2规范内容</p>
<h3 id="DAQ%E9%87%87%E6%A0%B7%E6%8E%A7%E5%88%B6%E5%91%BD%E4%BB%A4">DAQ采样控制命令</h3>
<h4 id="%E5%8D%95%E6%AC%A1%E6%B5%8B%E9%87%8F%E7%94%B5%E5%8E%8B">单次测量电压</h4>
<ul>
<li>格式：<strong>MEASure:VOLTage:DC? {1|2}</strong></li>
<li>功能：测量指定通道的电压</li>
<li>详细解释：用该命令触发DAQ对某一通道进行采样，采样的积分时间取决于目前的系统设置。支持AutoZero功能，<strong>需要注意，在开启AutoZero功能时，实际转换时间将加倍。</strong></li>
<li>示例：MEASure:VOLTage:DC? 1 或 MEAS:VOLT:DC? 1</li>
<li>返回值：对应通道的电压值</li>
</ul>
<h4 id="%E5%8D%95%E6%AC%A1%E6%B5%8B%E9%87%8F%E7%94%B5%E5%8E%8B%EF%BC%8C%E9%99%84%E5%B8%A6%E5%A4%96%E9%83%A8%E6%B8%A9%E5%BA%A6">单次测量电压，附带外部温度</h4>
<p><strong>该指令需要连接外部测温传感器TMP117，否则温度数据为0（TMP117为ti生产的版本，敏源传感生产的M117、T117等不可替代TMP117）</strong></p>
<ul>
<li>格式：<strong>MEASure:VOLTage:DC:TEMPerature? {1|2}</strong></li>
<li>功能：测量指定通道的电压，以及当前DAQ内部温度值</li>
<li>详细解释：用该命令触发DAQ对某一通道进行采样，采样的积分时间取决于目前的系统设置。支持AutoZero功能，<strong>需要注意，在开启AutoZero功能时，实际转换时间将加倍。</strong>。输出电压的同时，还会输出DAQ内部的温度。该指令适合长期监测时使用，测量电压的同时测量外部环境温度，供分析器件温度特性使用</li>
<li>示例：MEASure:VOLTage:DC:TEMPerature? 1 或 MEAS:VOLT:DC:TEMP? 1</li>
<li>返回值：对应通道的电压值，以及当前DAQ内部温度，两个数据以','分隔</li>
</ul>
<h4 id="%E5%8D%95%E6%AC%A1%E6%B5%8B%E9%87%8F%E9%80%9A%E9%81%93%E9%97%B4%E7%94%B5%E5%8E%8B%E6%AF%94%E4%BE%8B">单次测量通道间电压比例</h4>
<ul>
<li>格式：<strong>MEASure:VOLTage:RATio? {1|2}</strong></li>
<li>功能：测量2个通道间的电压值比例</li>
<li>详细解释：用该命令触发DAQ进行单次采样，分别测量通道1和通道2的电压值（支持AutoZero），然后计算出2个通道间的电压比例。<strong>命令的参数为比例计算中的分子</strong> ——即当命令的参数为1时，返回比例值为 (Volt1 / Volt2)；当命令参数为2时，返回比例值为 (Volt2 / Volt1)</li>
<li>示例：MEAS:VOLT:RATio? 1</li>
<li>返回值：2个通道的电压比例值，保留8位小数</li>
</ul>
<h4 id="%E8%AE%BE%E7%BD%AE%E9%87%87%E6%A0%B7%E7%A7%AF%E5%88%86%E5%91%A8%E6%9C%9F">设置采样积分周期</h4>
<blockquote>
<p>todo: 增加NPLC=5、NPLC=2.5的设定，下个版本固件和上位机更新</p>
</blockquote>
<ul>
<li>格式：<strong>CONFigure:VOLTage:DC:NPLCycles {0.1|0.25|0.5|1|10|100}</strong></li>
<li>功能：配置DAQ采样的积分时间 <strong>(Number of PowerLine Cycles)</strong></li>
<li>详细解释：用该命令设置DAQ采样的积分时间，积分时间越长，输出数据的噪声越低，电压有效位数越高。积分时间计算是依据工频电源周期数决定的，比如NPLC=10时，积分10个工频周期。默认市电频率是50Hz，周期20ms，那么10NPLC=200ms，对应5SPS/s的数据更新速率。<strong>需要注意，在开启AutoZero功能时，实际采样率将减半。</strong></li>
<li>示例：CONFigure:VOLTage:DC:NPLCycles 100</li>
<li>返回值：无</li>
</ul>
<h4 id="%E6%9F%A5%E8%AF%A2%E9%87%87%E6%A0%B7%E7%A7%AF%E5%88%86%E5%91%A8%E6%9C%9F">查询采样积分周期</h4>
<ul>
<li>格式：<strong>CONFigure:VOLTage:DC:NPLCycles?</strong></li>
<li>功能：查询DAQ采样的积分周期 <strong>(Number of PowerLine Cycles)</strong></li>
<li>详细解释：用该命令查询DAQ采样的积分周期，积分周期越多，输出数据的噪声越低，电压有效位数越高。<strong>需要注意，在开启AutoZero功能时，实际采样率将减半。</strong></li>
<li>示例：CONFigure:VOLTage:DC:NPLCycles?</li>
<li>返回值：返回当前DAQ的采样积分周期</li>
</ul>
<h4 id="%E8%AE%BE%E7%BD%AEDAQ%E8%BF%9E%E7%BB%AD%E9%87%87%E6%A0%B7">设置DAQ连续采样</h4>
<ul>
<li>格式：<strong>CONFigure:CONTinuous:READ {1|2},{ON|OFF}</strong></li>
<li>功能：设置DAQ的采样模式为单次（关闭CONT）或连续（开启CONT）</li>
<li>详细解释：用该命令设置DAQ的采样模式，某通道在单次采样模式下，DAQ只有接收到触发信号时才会采样并输出数据（触发信号来自SCPI指令）；某通道在连续转换模式下，DAQ将自动按照设置的NPLC进行连续转换并输出数据。请注意，同时只有一个通道能被激活连续转换模式。如果需要2个通道同时连续转换，请使用扫描模式。</li>
<li>示例：CONFigure:CONTinuous:READ 1,ON</li>
<li>返回值：无，但如果激活连续转换，随后紧跟对应的DAQ采样的数据</li>
</ul>
<h4 id="%E8%AE%BE%E7%BD%AEDAQ%E6%89%AB%E6%8F%8F%E9%87%87%E6%A0%B7">设置DAQ扫描采样</h4>
<ul>
<li>格式：<strong>CONFigure:CONTinuous:SCAN {ON|OFF}</strong></li>
<li>功能：设置DAQ的采样模式为扫描转换</li>
<li>详细解释：用该命令设置DAQ为连续扫描转换模式，该模式下DAQ先对CH1进行转换，然后对CH2进行转换，最后依次、同时输出2个通道的电压值。</li>
<li>示例：CONFigure:CONTinuous:SCAN ON</li>
<li>返回值：无，但如果激活连续扫描转换，随后紧跟对应的DAQ采样的数据</li>
</ul>
<h4 id="%E8%AE%BE%E7%BD%AEAutoZero">设置AutoZero</h4>
<p>AZ功能仅能消除内部信号链的失调误差，内部采用恒温设计后，AutoZero功能可以不使用。</p>
<ul>
<li>格式：<strong>CONFigure:AutoZero:DC {ON|OFF}</strong></li>
<li>功能：设置DAQ采样的自动校零功能</li>
<li>详细解释：用该命令设置DAQ的自动校零功能，AutoZero开启时，DAQ先测量信号链自身的失调电压，然后再测量输入信号电压，最后输出失调矫正过的数据。该模式仅对单次转换、单通道连续转换适用，暂不支持扫描转换。开启AutoZero后，对应的转换速率减半。（<strong>该功能不能消除外部热电势影响</strong>）</li>
<li>示例：CONFigure:AutoZero:DC ON</li>
<li>返回值：无</li>
</ul>
<h3 id="DAQ%E7%A1%AC%E4%BB%B6%E9%85%8D%E7%BD%AE%E5%91%BD%E4%BB%A4">DAQ硬件配置命令</h3>
<h4 id="%E6%9F%A5%E8%AF%A2DAQ%E7%B3%BB%E7%BB%9F%E8%AE%BE%E7%BD%AE">查询DAQ系统设置</h4>
<ul>
<li>格式：<strong>CONFigure:INFormation?</strong></li>
<li>功能：查询DAQ当前的系统设置</li>
<li>详细解释：用该命令查询DAQ的系统设置，包括 <strong>波特率（仅使用USART接口的固件支持）</strong> (带外壳的DAQ使用USB-VCP通信，无需设置波特率)、NPLC频率、NPLC周期数、AutoZero是否开启</li>
<li>示例：CONFIGURE:INFormation?</li>
<li>返回值：波特率、NPLC频率、NPLC周期数、AutoZero是否开启</li>
</ul>
<h4 id="%E8%AE%BE%E7%BD%AE%E5%86%85%E9%83%A8%E5%8A%A0%E7%83%AD%E6%81%92%E6%B8%A9%E6%B8%A9%E5%BA%A6">设置内部加热恒温温度</h4>
<ul>
<li>格式：<strong>HEAT:TEMP {temperature}</strong></li>
<li>功能：设置内部加热恒温温度</li>
<li>详细解释：用该命令设置内部加热恒温温度，单位为摄氏度，温度范围为20-42度，<strong>该温度值会保存在EEPROM中</strong>，重启后仍然有效。<strong>推荐设置温度为35度</strong>，DAQ的出厂校准温度也是35度。</li>
<li>示例：HEAT:TEMP 35</li>
<li>返回值：提示温度设定值已更新</li>
</ul>
<h4 id="%E6%9F%A5%E8%AF%A2%E5%86%85%E9%83%A8%E5%8A%A0%E7%83%AD%E6%81%92%E6%B8%A9%E6%B8%A9%E5%BA%A6">查询内部加热恒温温度</h4>
<ul>
<li>格式：<strong>HEAT:TEMP?</strong></li>
<li>功能：查询内部加热恒温温度</li>
<li>详细解释：用该命令查询内部加热恒温温度，单位为摄氏度，温度范围为20-42度。</li>
<li>示例：HEAT:TEMP?</li>
<li>返回值：加热恒温温度设定值</li>
</ul>
<h3 id="DAQ%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4">DAQ系统命令</h3>
<h4 id="%E6%B5%8B%E9%87%8F%E6%9D%BF%E4%B8%8A%E6%B8%A9%E5%BA%A6">测量板上温度</h4>
<ul>
<li>格式：<strong>MEASure:INTernal:TEMPerature?</strong></li>
<li>功能：测量DAQ当前的板上温度</li>
<li>详细解释：用该命令激活板上温度传感器，测量基准和ADC附近的温度值，返回给用户。</li>
<li>示例：MEASure:INT:TEMP?</li>
<li>返回值：板上温度，保留3-4位小数</li>
</ul>
<h4 id="%E6%B5%8B%E9%87%8F%E5%A4%96%E9%83%A8%E6%B8%A9%E5%BA%A6">测量外部温度</h4>
<ul>
<li>格式：<strong>MEASure:EXTernal:TEMPerature?</strong></li>
<li>功能：测量外部连接的TMP117传感器温度数据</li>
<li>详细解释：用该命令测量外部温度传感器，<strong>传感器的地址管脚必须连接到VCC</strong>（I2C地址固定为0x49，地址0x48被板上温度传感器占用），测量外部温度值，返回给用户。</li>
<li>示例：MEASure:EXT:TEMP?</li>
<li>返回值：外部温度，保留3-4位小数</li>
</ul>
<h4 id="%E7%81%AF%E5%85%89%E6%8C%87%E7%A4%BA">灯光指示</h4>
<ul>
<li>格式：<strong>SYSTem:IDENtify</strong></li>
<li>功能：闪烁后面板的ERR指示灯</li>
<li>详细解释：闪烁后面板的ERR指示灯，用于指示当前收到指令的DAQ。在连接多个DAQ时用于区分DAQ。DAQ收到该命令后，背板上的蓝色ERR指示灯将闪烁5次，间隔时间1秒。</li>
<li>示例：SYSTem:IDEN</li>
<li>返回值：无</li>
</ul>
<h4 id="%E7%94%A8%E6%88%B7%E5%A2%9E%E7%9B%8A%E6%A0%A1%E5%87%86">用户增益校准</h4>
<ul>
<li>格式: SYSTem:CALibration:GAIN {gain}</li>
<li>功能：写入DAQ的系统增益,并保存</li>
<li>详细解释： 写入DAQ的系统增益,该增益是线性回归拟合校准得出的增益误差,在DAQ内部参与电压转换的计算,补偿DAQ的系统增益误差</li>
<li>示例：SYSTem:CAL:GAIN 1.00032855</li>
<li>返回值：写入的增益值,并提示保存成功与否</li>
</ul>
<h4 id="%E6%9F%A5%E8%AF%A2%E7%94%A8%E6%88%B7%E5%A2%9E%E7%9B%8A%E6%A0%A1%E5%87%86%E7%B3%BB%E6%95%B0">查询用户增益校准系数</h4>
<ul>
<li>格式: SYSTem:CALibration:GAIN?</li>
<li>功能：查询增益校准系数</li>
<li>详细解释： 查询DAQ内部存储的增益校准系数</li>
<li>示例：SYSTem:CAL:GAIN?</li>
<li>返回值：1.00032855</li>
</ul>
<h4 id="%E7%94%A8%E6%88%B7%E5%A4%B1%E8%B0%83%E6%A0%A1%E5%87%86">用户失调校准</h4>
<ul>
<li>格式: SYSTem:CALibration:OFFSET {offset}</li>
<li>功能：写入DAQ的系统失调误差,并保存</li>
<li>详细解释：  写入DAQ的系统失调误差,该增益是线性回归拟合校准得出的失调误差,在DAQ内部参与电压转换的计算,补偿DAQ的系统失调误差</li>
<li>示例：SYSTem:CAL:OFFSET 0.00003882</li>
<li>返回值：写入的失调值,并提示保存成功与否</li>
</ul>
<h4 id="%E6%9F%A5%E8%AF%A2%E7%94%A8%E6%88%B7%E5%A4%B1%E8%B0%83%E6%A0%A1%E5%87%86%E7%B3%BB%E6%95%B0">查询用户失调校准系数</h4>
<ul>
<li>格式: SYSTem:CALibration:OFFSET?</li>
<li>功能：查询失调校准系数</li>
<li>详细解释： 查询DAQ内部存储的失调校准系数</li>
<li>示例：SYSTem:CAL:OFFSET?</li>
<li>返回值：0.00003882</li>
</ul>
<h4 id="ADC%E7%B3%BB%E7%BB%9F%E6%A0%A1%E5%87%86">ADC系统校准</h4>
<ul>
<li>格式: SYSTem:CALibration:ADC</li>
<li>功能：执行ADC系统校准</li>
<li>详细解释： 该功能执行的是ADC片内自带的校准程序,分别给ADC输入通入0V和VREF,以此来计算ADC前面所有信号链的失调和增益误差.但此方法由于ADC的INL限制,效果有限.如果需要高精度,还是需要高位表+源来校准标定.该过程需要约20秒的时间完成,且需要在DAQ充分预热且环境温度较稳定的情况下进行</li>
<li>示例：SYSTem:CAL:ADC</li>
<li>返回值：校准前的增益\失调寄存器,与校准后的增益\失调寄存器</li>
</ul>
<h4 id="%E5%86%99%E5%85%A5%E6%A0%A1%E5%87%86%E6%97%A5%E6%9C%9F">写入校准日期</h4>
<ul>
<li>格式: SYSTem:CALibration:DATE {yyyy},{mm},{dd}</li>
<li>功能：写入校准日期</li>
<li>详细解释： 写入校准日期,格式是: yyyy,mm,dd</li>
<li>示例：SYST:CAL:DATE 1919,8,10</li>
<li>返回值：无</li>
</ul>
<h4 id="%E5%AD%98%E5%82%A8ADC%E7%B3%BB%E7%BB%9F%E6%A0%A1%E5%87%86%E6%95%B0%E6%8D%AE">存储ADC系统校准数据</h4>
<ul>
<li>格式: SYSTem:CALibration:STORE</li>
<li>功能：保存ADC系统校准数据,以及校准日期</li>
<li>详细解释： 保存ADC系统校准数据,以及校准日期</li>
<li>示例：SYST:CAL:STORE</li>
<li>返回值：保存成功以及校准数据明细,如果有未执行的校准项将提示校准未完成</li>
</ul>
<h4 id="%E6%93%A6%E9%99%A4%E6%A0%A1%E5%87%86%E6%95%B0%E6%8D%AE">擦除校准数据</h4>
<ul>
<li>格式: SYSTem:CALibration:DEFAULT</li>
<li>功能：擦除所有校准数据</li>
<li>详细解释： 擦除所有校准数据,包括ADC系统校准寄存器\手动输入的增益失调误差\校准日期等</li>
<li>示例：SYST:CAL:DEFAULT</li>
<li>返回值：校准数据复位成功</li>
</ul>
<h4 id="%E6%9F%A5%E8%AF%A2%E6%89%80%E6%9C%89%E6%A0%A1%E5%87%86%E6%95%B0%E6%8D%AE">查询所有校准数据</h4>
<ul>
<li>格式: SYSTem:CALibration:INFormation?</li>
<li>功能：查询校准数据</li>
<li>详细解释： 查询所有校准数据,包括ADC系统校准寄存器\手动输入的增益失调误差\校准日期等</li>
<li>示例：SYST:CAL:INF?</li>
<li>返回值：有效校准数据,若未执行过校准/校准数据被擦除,则提示校准数据不存在</li>
</ul>
<h4 id="%E7%B3%BB%E7%BB%9F%E5%9B%BA%E4%BB%B6%E5%8D%87%E7%BA%A7">系统固件升级</h4>
<blockquote>
<p>需要安装STM32 USB DFU驱动，建议直接安装STM32CubeProgrammer，以方便升级。</p>
</blockquote>
<ul>
<li>格式: SYSTem:Update</li>
<li>功能：使DAQ进入升级模式</li>
<li>详细解释： 该命令将解除DAQ初始化，使其进入DFU(Device Firmware Upgrade)模式。在此模式下，通过STM32CubeProgrammer连接DAQ，可以对其进行固件升级。</li>
<li>示例：SYSTem:Update</li>
<li>返回值：无，命令执行后，USB端口立刻断开连接。</li>
</ul>
<h2 id="DAQ%E6%A0%A1%E5%87%86%E5%8E%9F%E7%90%86">DAQ校准原理</h2>
<p>请参考Emoe上的文章 <strong><a href="https://www.emoe.xyz/emoedaq-design-2/#5"  target="_blank">EmoeDAQ-高精度数据采集器-下篇</a></strong> 中的第五节-校准原理</p>
<h2 id="%E6%A0%A1%E5%87%86%E8%AF%B4%E6%98%8E">校准说明</h2>
<p>校准的本质是将DAQ的绝对精度调整到与参考表的精度较为一致的水平，所以，<strong>决定校准后精度的是参考表的精度</strong>。<br />
如果需要绝对的精确度，那就需要绝对精确的参考表，比如短期内经过约瑟夫森结传递校准过的Keysight 3458A DMM 或 Fluke的高位Calibrator。</p>
<h2 id="DAQ%E6%A0%A1%E5%87%86%E6%B5%81%E7%A8%8B">DAQ校准流程</h2>
<h3 id="%E6%A0%A1%E5%87%86%E6%89%80%E9%9C%80%E8%A6%81%E7%9A%84%E8%AE%BE%E5%A4%87">校准所需要的设备</h3>
<p>DAQ的直流精度超过 5½ 数字万用表，所以至少需要 6½ 的数字万用表作为校准参考表。同时还需要一个低噪声、极稳定的可调节直流源，如果校准源的噪声较高或漂移较大，会增大校准过程中的不确定性，导致校准精度不及预期。推荐设备如下：</p>
<ul>
<li>Keysight 34465A或同等级、甚至更高等级的台式DMM</li>
<li>5位半以上的DC源表，能够产生-5V至+5V的可调电压输出</li>
<li>铜芯线用于连接</li>
</ul>
<h3 id="%E6%8E%A8%E8%8D%90%E6%A0%A1%E5%87%86%E6%B5%81%E7%A8%8B-%E8%87%AA%E5%8A%A8%E7%89%88">推荐校准流程-自动版</h3>
<p>如果有可连接至PC的DMM和源表，且能被VISA识别到，可以使用python来完成自动化校准。<br />
🐟使用的是 Keysight 34465A+横河7651，DMM使用USB连接，7651使用GPIB连接。</p>
<ol start="0">
<li>将DAQ连接到电脑，发送指令 <strong>HEAT:TEMP 35</strong> 设定内部恒温温度，此数值将作为校准时的温度保存到校准数据中。</li>
<li>将源表输出连接到DAQ的CH1输入端（DAQ的INN接地，INP连接源表输出正极）和DMM的电压输入端</li>
<li>使用稳定且足功率的USB端口连接DAQ，通电静置至少2小时让DAQ和其他仪器充分稳定，DMM与源表同步上电静置。</li>
<li>测试VISA连接DMM与源表，能否正常通信，根据自己的设备修改相应的SCPI控制指令</li>
<li>修改校准程序的校准日期等内容，运行自动化校准程序，完成校准</li>
<li>打开串口助手，连接DAQ，查询校准结果是否正确</li>
</ol>
<h3 id="%E6%89%8B%E5%8A%A8%E6%A0%A1%E5%87%86">手动校准</h3>
<p>如果上述自动校准条件不具备，可以使用手动校准的方式。<strong>不过需注意，无论是哪种校准方式都需要一台高位DMM，以及一个低噪声且稳定可调的电压源。</strong></p>
<p>为达到最佳校准精度，推荐使用多点校准拟合的方式来得出增益与失调系数。<br />
DAQ的手动校准分为2步，分别是ADC系统校准和用户自定义比对参考表校准。下面给出一个示例：</p>
<ol start="0">
<li>将DAQ连接到电脑，发送指令 <strong>HEAT:TEMP 35</strong> 设定内部恒温温度，此数值将作为校准时的温度保存到校准数据中。</li>
<li>使用稳定且足功率的USB端口连接DAQ，通电静置至少2小时让DAQ和其他仪器充分稳定，DMM与源表同步上电静置。</li>
<li>将DAQ连接串口助手，手动发送指令 <strong>&quot;SYST:CAL:ADC&quot;</strong> 执行ADC的系统校准，等待20秒输出结果；</li>
<li>手动发送指令 <strong>&quot;SYST:CAL:DATE 2025,1,14&quot;</strong> ，写入校准的日期</li>
<li>手动发送指令 <strong>&quot;SYST:CAL:STORE&quot;</strong> ，保存ADC系统校准数据</li>
<li>将源表输出连接到DAQ的CH1输入端（DAQ的INN接地，INP连接源表输出正极）和DMM的电压输入端</li>
<li>调整源表输出至-4.9V，等待DAQ和DMM读数稳定后记录数值，填入Excel表格</li>
<li>重复上述操作，使源表分别输出-4.9V、-4V、-3V、-2V、... 0V、... 、+4V、+4.9V，记录数据</li>
<li>在Excel中将DMM读数和DAQ读数整理为2列，然后根据这些数据计算一次线性回归系数（可以调用Excel的函数功能）</li>
<li>得到校准系数后，将DAQ连接串口助手，通过校准指令 <strong>&quot;SYST:CAL:GAIN 1.00002243123&quot;、&quot;SYST:CAL:OFFSET 0.000004232&quot;</strong>手动写入DAQ（此处数字仅示例）</li>
<li>发送指令 <strong>&quot;SYST:CAL:INF?&quot;</strong> 查询校准数据是否正确</li>
</ol>
<h1 id="Change-Log">Change Log</h1>
<ul>
<li>2025.04.02 修改NPLC部分描述问题</li>
<li>2025.04.12 修改部分指令描述问题，增加todo功能（挖坑</li>
</ul>

                        
                    </div>
                </div>
                <div id="previous_next">
                    <div id="previous">
                        
                        <a href="/projects/EmoeDAQ/emoedaq-spec.html">
                            <span class="icon"></span>
                            <span class="label">EmoeDAQ Datasheet</span>
                        </a>
                        
                    </div>
                    <div id="next">
                        
                    </div>
                </div>
                <div id="comments-container"></div>
            </div>
            <div id="toc_wrapper">
                <div id="toc">
                    <div id="toc_content">
                            
                    </div>
                </div>
            </div>
        </div>
    </div>
    <a id="to_top" href="#"></a>
    <div id="doc_footer">
        <div id="footer">
            <div id="footer_top">
                <ul>
<li><a>链接</a><ul><li><a target="_blank" href="https://teedoc.neucrack.com">Build by teedoc</a></li>
<li><a target="_blank" href="/sitemap.xml">网站地图</a></li>
</ul>
</li>
<li><a>外部链接</a><ul><li><a target="_blank" href="https://github.com/neutree/teedoc">github</a></li>
<li><a target="_blank" href="https://gitee.com/teedoc/teedoc">gitee</a></li>
<li><a target="_blank" href="https://github.com/teedoc/teedoc.github.io">本网站源文件</a></li>
</ul>
</li>
</ul>

            </div>
            <div id="footer_bottom">
                <ul>
<li><a target="_blank" href="https://beian.miit.gov.cn">ICP备19019064号</a></li>
</ul>

            </div>
        </div>
    </div>
    
        <script src="/teedoc-plugin-markdown-parser/mermaid.min.js"></script>
    
        <script>mermaid.initialize({startOnLoad:true});</script>
    
        <script src="/static/js/theme_default/tocbot.min.js"></script>
    
        <script src="/static/js/theme_default/main.js"></script>
    
        <script src="/static/js/theme_default/viewer.min.js"></script>
    
        <script src="/static/css/theme_default/prism.min.js"></script>
    
        <script src="/static/js/search/search_main.js"></script>
    
        <script src="/static/js/plugin_blog/main.js"></script>
    
        <script src="/static/js/custom.js"></script>
    
</body>

</html>